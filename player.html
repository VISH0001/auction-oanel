<!DOCTYPE html>
<html>
<head>
<title>Stats Loader</title>
</head>

<body>
    <h3>Enter Player Serial Number:</h3>
    <input id="srNo" type="text" placeholder="Enter SR No">
    <button onclick="loadAll()">Load Stats</button>

<script>
let battingTab = null;
let bowlingTab = null;

function loadAll() {
    const sr = document.getElementById("srNo").value.trim();
    if (!sr) return;

    const playerId = sr;  
    const playerName = "John-Doe";  

    const baseUrl = `https://cricheroes.com/player-profile/${playerId}/${playerName}/stats`;

    const battingUrl = baseUrl;
    const bowlingUrl = baseUrl + "?tab=bowling";

    // ---------------------------
    // 1) OPEN OR REUSE BATTING TAB
    // ---------------------------
    if (!battingTab || battingTab.closed) {
        battingTab = window.open(battingUrl, "battingTab");
    } else {
        battingTab.location.href = battingUrl;
    }

    // Run automation after load
    battingTab.onload = () => {
        scrollToBottom(battingTab);
    };

    // ---------------------------
    // 2) OPEN OR REUSE BOWLING TAB
    // ---------------------------
    if (!bowlingTab || bowlingTab.closed) {
        bowlingTab = window.open(bowlingUrl, "bowlingTab");
    } else {
        bowlingTab.location.href = bowlingUrl;
    }

    // Run automation after load
    bowlingTab.onload = () => {
        openBowlingTab(bowlingTab);
        scrollToBottom(bowlingTab);
        tryClickCaptcha(bowlingTab);
    };
}


// --------------------------------------------
// AUTOMATION FUNCTIONS
// --------------------------------------------

function scrollToBottom(tab) {
    try {
        tab.scrollTo(0, tab.document.body.scrollHeight);
    } catch (e) {}
}

function openBowlingTab(tab) {
    try {
        const btn = tab.document.querySelector('div[value="bowling"]');
        if (btn) btn.click();
    } catch (e) {}
}

function tryClickCaptcha(tab) {
    try {
        const iframe = tab.document.querySelector('iframe[title="reCAPTCHA"]');
        if (iframe) {
            const frameDoc = iframe.contentDocument || iframe.contentWindow.document;
            const checkbox = frameDoc.querySelector('.recaptcha-checkbox-border');
            if (checkbox) checkbox.click();
        }
    } catch (e) {}
}
</script>

</body>
</html>
